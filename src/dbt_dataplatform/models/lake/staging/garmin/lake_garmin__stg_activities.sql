{{
  config(
      tags=['garmin', 'lake']
  )
}}

SELECT
    ACTIVITYID,
    ACTIVITYNAME,
    STARTTIMELOCAL,
    STARTTIMEGMT,
    ACTIVITYTYPE,
    EVENTTYPE,
    DISTANCE,
    DURATION,
    ELAPSEDDURATION,
    MOVINGDURATION,
    ELEVATIONGAIN,
    ELEVATIONLOSS,
    AVERAGESPEED,
    MAXSPEED,
    STARTLATITUDE,
    STARTLONGITUDE,
    HASPOLYLINE,
    HASIMAGES,
    OWNERID,
    OWNERDISPLAYNAME,
    OWNERFULLNAME,
    OWNERPROFILEIMAGEURLSMALL,
    OWNERPROFILEIMAGEURLMEDIUM,
    OWNERPROFILEIMAGEURLLARGE,
    CALORIES,
    BMRCALORIES,
    AVERAGEHR,
    MAXHR,
    AVERAGERUNNINGCADENCEINSTEPSPERMINUTE,
    MAXRUNNINGCADENCEINSTEPSPERMINUTE,
    STEPS,
    USERROLES,
    PRIVACY,
    USERPRO,
    HASVIDEO,
    TIMEZONEID,
    BEGINTIMESTAMP,
    SPORTTYPEID,
    AVGPOWER,
    MAXPOWER,
    AEROBICTRAININGEFFECT,
    ANAEROBICTRAININGEFFECT,
    NORMPOWER,
    AVGVERTICALOSCILLATION,
    AVGGROUNDCONTACTTIME,
    AVGSTRIDELENGTH,
    VO2MAXVALUE,
    AVGVERTICALRATIO,
    DEVICEID,
    MINTEMPERATURE,
    MAXTEMPERATURE,
    MINELEVATION,
    MAXELEVATION,
    MAXDOUBLECADENCE,
    SUMMARIZEDDIVEINFO,
    MAXVERTICALSPEED,
    MANUFACTURER,
    LOCATIONNAME,
    LAPCOUNT,
    ENDLATITUDE,
    ENDLONGITUDE,
    WATERESTIMATED,
    TRAININGEFFECTLABEL,
    ACTIVITYTRAININGLOAD,
    MINACTIVITYLAPDURATION,
    AEROBICTRAININGEFFECTMESSAGE,
    ANAEROBICTRAININGEFFECTMESSAGE,
    SPLITSUMMARIES,
    HASSPLITS,
    MODERATEINTENSITYMINUTES,
    VIGOROUSINTENSITYMINUTES,
    AVGGRADEADJUSTEDSPEED,
    DIFFERENCEBODYBATTERY,
    HASHEATMAP,
    FASTESTSPLIT_1000,
    FASTESTSPLIT_1609,
    FASTESTSPLIT_5000,
    FASTESTSPLIT_10000,
    FASTESTSPLIT_21098,
    FASTESTSPLIT_42195,
    HRTIMEINZONE_1,
    HRTIMEINZONE_2,
    HRTIMEINZONE_3,
    HRTIMEINZONE_4,
    HRTIMEINZONE_5,
    POWERTIMEINZONE_1,
    POWERTIMEINZONE_2,
    POWERTIMEINZONE_3,
    POWERTIMEINZONE_4,
    POWERTIMEINZONE_5,
    ENDTIMEGMT,
    QUALIFYINGDIVE,
    AUTOCALCCALORIES,
    FAVORITE,
    DECODIVE,
    PURPOSEFUL,
    PR,
    MANUALACTIVITY,
    PARENT,
    ELEVATIONCORRECTED,
    ATPACTIVITY,
    DP_INSERTED_AT
FROM {{ source('garmin','activities') }}
QUALIFY
    ROW_NUMBER() OVER (PARTITION BY activityid ORDER BY dp_inserted_at DESC) = 1
