SELECT
	activityId,
	activityName,
	startTimeLocal,
	startTimeGMT,
	activityType,
	eventType,
	distance,
	duration,
	elapsedDuration,
	movingDuration,
	elevationGain,
	elevationLoss,
	averageSpeed,
	maxSpeed,
	startLatitude,
	startLongitude,
	hasPolyline,
	hasImages,
	ownerId,
	ownerDisplayName,
	ownerFullName,
	ownerProfileImageUrlSmall,
	ownerProfileImageUrlMedium,
	ownerProfileImageUrlLarge,
	calories,
	bmrCalories,
	averageHR,
	maxHR,
	averageRunningCadenceInStepsPerMinute,
	maxRunningCadenceInStepsPerMinute,
	steps,
	userRoles,
	privacy,
	userPro,
	hasVideo,
	timeZoneId,
	beginTimestamp,
	sportTypeId,
	avgPower,
	maxPower,
	aerobicTrainingEffect,
	anaerobicTrainingEffect,
	normPower,
	avgVerticalOscillation,
	avgGroundContactTime,
	avgStrideLength,
	vO2MaxValue,
	avgVerticalRatio,
	deviceId,
	minTemperature,
	maxTemperature,
	minElevation,
	maxElevation,
	maxDoubleCadence,
	summarizedDiveInfo,
	maxVerticalSpeed,
	manufacturer,
	locationName,
	lapCount,
	endLatitude,
	endLongitude,
	waterEstimated,
	trainingEffectLabel,
	activityTrainingLoad,
	minActivityLapDuration,
	aerobicTrainingEffectMessage,
	anaerobicTrainingEffectMessage,
	splitSummaries,
	hasSplits,
	moderateIntensityMinutes,
	vigorousIntensityMinutes,
	avgGradeAdjustedSpeed,
	differenceBodyBattery,
	hasHeatMap,
	fastestSplit_1000,
	fastestSplit_1609,
	fastestSplit_5000,
	fastestSplit_10000,
	fastestSplit_21098,
	hrTimeInZone_1,
	hrTimeInZone_2,
	hrTimeInZone_3,
	hrTimeInZone_4,
	hrTimeInZone_5,
	powerTimeInZone_1,
	powerTimeInZone_2,
	powerTimeInZone_3,
	powerTimeInZone_4,
	powerTimeInZone_5,
	endTimeGMT,
	qualifyingDive,
	pr,
	parent,
	decoDive,
	elevationCorrected,
	atpActivity,
	purposeful,
	favorite,
	manualActivity,
	autoCalcCalories,
	minRespirationRate,
	maxRespirationRate,
	avgRespirationRate,
	summarizedExerciseSets,
	totalSets,
	activeSets,
	totalReps,
	fastestSplit_42195,
	workoutId,
	caloriesConsumed,
	waterConsumed,
	avgVerticalSpeed,
	description,
	courseId,
	calendarEventUuid,
	data_type,
	TIMESTAMP(`_dp_inserted_at`) AS _dp_inserted_at,
	`_source_file`
FROM {{ source('garmin','activities') }}
QUALIFY
    ROW_NUMBER() OVER (PARTITION BY activityId ORDER BY TIMESTAMP(`_dp_inserted_at`) DESC) = 1
