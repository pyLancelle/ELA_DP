SELECT
    ACTIVITYID,
    ACTIVITYNAME,
    STARTTIMELOCAL,
    STARTTIMEGMT,
    ENDTIMEGMT,
    BEGINTIMESTAMP,
    TIMEZONEID,
    LOCATIONNAME,
    DATA_TYPE,
    ACTIVITYTYPE,
    EVENTTYPE,
    SPORTTYPEID,
    OWNERID,
    OWNERDISPLAYNAME,
    OWNERFULLNAME,
    OWNERPROFILEIMAGEURLSMALL,
    OWNERPROFILEIMAGEURLMEDIUM,
    OWNERPROFILEIMAGEURLLARGE,
    USERPRO,
    DISTANCE,
    DURATION,
    ELAPSEDDURATION,
    MOVINGDURATION,
    AVERAGESPEED,
    MAXSPEED,
    AVGGRADEADJUSTEDSPEED,
    MAXVERTICALSPEED,
    ELEVATIONGAIN,
    ELEVATIONLOSS,
    MINELEVATION,
    MAXELEVATION,
    ELEVATIONCORRECTED,
    STARTLATITUDE,
    STARTLONGITUDE,
    ENDLATITUDE,
    ENDLONGITUDE,
    HASPOLYLINE,
    AVERAGEHR,
    MAXHR,
    HRTIMEINZONE_1,
    HRTIMEINZONE_2,
    HRTIMEINZONE_3,
    HRTIMEINZONE_4,
    HRTIMEINZONE_5,
    AVGPOWER,
    MAXPOWER,
    NORMPOWER,
    POWERTIMEINZONE_1,
    POWERTIMEINZONE_2,
    POWERTIMEINZONE_3,
    POWERTIMEINZONE_4,
    POWERTIMEINZONE_5,
    STEPS,
    AVERAGERUNNINGCADENCEINSTEPSPERMINUTE,
    MAXRUNNINGCADENCEINSTEPSPERMINUTE,
    MAXDOUBLECADENCE,
    AVGSTRIDELENGTH,
    AVGGROUNDCONTACTTIME,
    AVGVERTICALOSCILLATION,
    AVGVERTICALRATIO,
    CALORIES,
    BMRCALORIES,
    AUTOCALCCALORIES,
    DIFFERENCEBODYBATTERY,
    VO2MAXVALUE,
    AEROBICTRAININGEFFECT,
    AEROBICTRAININGEFFECTMESSAGE,
    ANAEROBICTRAININGEFFECT,
    ANAEROBICTRAININGEFFECTMESSAGE,
    TRAININGEFFECTLABEL,
    ACTIVITYTRAININGLOAD,
    MODERATEINTENSITYMINUTES,
    VIGOROUSINTENSITYMINUTES,
    FASTESTSPLIT_1000,
    FASTESTSPLIT_1609,
    FASTESTSPLIT_5000,
    FASTESTSPLIT_10000,
    FASTESTSPLIT_21098,
    FASTESTSPLIT_42195,
    MINTEMPERATURE,
    MAXTEMPERATURE,
    DEVICEID,
    MANUFACTURER,
    MANUALACTIVITY,
    LAPCOUNT,
    MINACTIVITYLAPDURATION,
    HASSPLITS,
    HASHEATMAP,
    PRIVACY,
    HASIMAGES,
    HASVIDEO,
    FAVORITE,
    PR,
    PARENT,
    ATPACTIVITY,
    PURPOSEFUL,
    DECODIVE,
    QUALIFYINGDIVE,
    WATERESTIMATED,
    DP_INSERTED_AT
FROM {{ source('garmin','activity_details') }}
QUALIFY
    ROW_NUMBER() OVER (PARTITION BY activityid ORDER BY dp_inserted_at DESC) = 1
